<!DOCTYPE html>
<html>

	<head lang='zh'>
		<meta charset='utf-8'>
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="renderer" content="webkit" />
		<meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=0" />
		<title>Luckysheet</title>

		<link rel='stylesheet' href='./plugins/css/pluginsCss.css' />
		<link rel='stylesheet' href='./plugins/plugins.css' />
		<link rel='stylesheet' href='./css/luckysheet.css' />
		<link rel='stylesheet' href='./assets/iconfont/iconfont.css' />
		<script src="./plugins/js/plugin.js"></script>

		<!-- rollup luckysheet.js -->
		<script src="./luckysheet.umd.js"></script>

	</head>

	<body>
		<!-- <div style="height: 300px;">
		多选模式（默认即多选模式）：
		<textarea style="width: 300px" checks="1" type="text" readonly></textarea>
	</div> -->
		<div style="height: 300px;">
			<div id="luckysheet"
				style="margin:0px;padding:0px;position:absolute;width:100%;height:100%;left: 0px;top: 0px;">
			</div>
			<!-- demo feature, non-production use -->
			<script src="./demoData/demoFeature.js"></script>
			<script src="./demoData/sheetFormula.js"></script>
			<script src="./demoData/sheetCell.js"></script>
			<script src="./demoData/sheetConditionFormat.js"></script>
			<script src="./demoData/sheetTable.js"></script>
			<script src="./demoData/sheetComment.js"></script>
			<script src="./demoData/sheetPivotTableData.js"></script>
			<script src="./demoData/sheetPivotTable.js"></script>
			<script src="./demoData/sheetSparkline.js"></script>
			<script src="./demoData/sheetChart.js"></script>
			<script src="./demoData/sheetPicture.js"></script>
			<script src="./demoData/sheetDataVerification.js"></script>
			<script src="luckSheetCustomFormula.js"></script>
			<!-- <link type="text/css" rel="stylesheet" href="./lib/tree/css/demo.css"> -->
			<link type="text/css" rel="stylesheet" href="./css/ztreecss/metroStyle/metroStyle.css">

		</div>

		<div id="printFrame"></div>
		<!-- Non-full screen test -->
		<!-- <div style="position: relative;width: 100%;height: 100%;">

		<div id="luckysheet" style="margin:0px;padding:0px;position:absolute;width:80%;height:500px;left: 20%;top: 200px;bottom:0;right: 0;"></div>
	</div> -->

		<script>
			// import sheetFormula from './demoData/sheetFormula.js'
			// import sheetCell from './demoData/sheetCell.js'
			// import sheetConditionFormat from './demoData/sheetConditionFormat.js'
			// import sheetTable from './demoData/sheetTable.js'
			// import sheetComment from './demoData/sheetComment.js'
			// import sheetPivotTableData from './demoData/sheetPivotTableData.js'
			// import sheetPivotTable from './demoData/sheetPivotTable.js'
			// import sheetSparkline from './demoData/sheetSparkline.js'
			// import sheetChart from './demoData/sheetChart.js'
			// import sheetPicture from './demoData/sheetPicture.js'
			// import sheetDataVerification from './demoData/sheetDataVerification.js'
			var obj = null;
			$(function() {
				// var zNodes = [
				// 	{ id: 1, pId: 0, name: "火之国", open: true },
				// 	{ id: 11, pId: 1, name: "木叶忍者", open: true },
				// 	{ id: 111, pId: 11, name: "鸣人" },
				// 	{ id: 112, pId: 11, name: "佐助" },
				// 	{ id: 12, pId: 1, name: "木叶暗部" },
				// 	{ id: 121, pId: 12, name: "鼬" },
				// 	{ id: 122, pId: 12, name: "卡卡西" },
				// 	{ id: 2, pId: 0, name: "沙之国", open: true },
				// 	{ id: 21, pId: 2, name: "千代婆婆" },
				// 	{ id: 26, pId: 2, name: "我爱罗" },
				// 	{ id: 22, pId: 2, name: "沙之国忍者", open: true },
				// 	{ id: 221, pId: 22, name: "手鞠" },
				// 	{ id: 222, pId: 22, name: "勘九郎" },
				// 	{ id: 3, pId: 0, name: "水之国" },
				// 	{ id: 4, pId: 0, name: "雨隐" },
				// 	{ id: 4, pId: 0, name: "土之国" },
				// 	{ id: 4, pId: 0, name: "暗部" },
				// ];
				// var defaults = {
				// 	textLabel: "jasontext",
				// 	zNodes: zNodes,
				// 	height: 333,
				// 	chkStyle: "radio"
				// }
				// $("textarea").drawMultipleTree(defaults);
				// var zNodes = [
				// 	{ id: 1, pId: 0, name: "草帽团", open: true },
				// 	{ id: 11, pId: 1, name: "索隆", open: true },
				// 	{ id: 12, pId: 1, name: "路飞" },
				// 	{ id: 13, pId: 1, name: "山治" },
				// 	{ id: 14, pId: 1, name: "乌索普" },
				// 	{ id: 15, pId: 1, name: "娜美" },
				// 	{ id: 16, pId: 1, name: "布鲁克" },
				// 	{ id: 16, pId: 1, name: "乔巴" },
				// 	{ id: 2, pId: 0, name: "红心海贼团", open: true },
				// 	{ id: 21, pId: 2, name: "罗" },
				// 	{ id: 26, pId: 2, name: "贝波" },
				// 	{ id: 22, pId: 2, name: "强巴鲁" }
				// ];
				/*注册下拉树方法也很简单*/

				// obj = $("textarea").treeSelect({
				// 	zNodes: zNodes,
				// 	//height: 333,

				// 	data: {
				// 		key: {
				// 			name: "name",
				// 			isParent: "isParent"
				// 		},
				// 		simpleData: {
				// 			enable: true,
				// 			idKey: "id",
				// 			pIdKey: "pId",
				// 			rootPId: 0
				// 		}
				// 	},
				// });
				// According to the browser language
				var lang = luckysheetDemoUtil.language() === 'zh' ? 'zh' : 'en';
				var isShare = luckysheetDemoUtil.getRequest().share; // '?share=1' opens the collaborative editing mode
				var gridKey = luckysheetDemoUtil.getRequest()
					.gridKey; // workbook id for collaborative editing, or directly define here
				var options = null;

				if (isShare || gridKey) {
					// http://localhost:3000/?gridKey=12eyy789-kk45ofid-23737245
					if (!gridKey) {
						alert('If gridKey is not provided in the address bar, please add it in the source code')
					}
					options = {
						container: "luckysheet",
						lang: lang,
						allowUpdate: true,
						updateImageUrl: location.origin + "/luckysheet/api/updateImg",
						updateUrl: "ws://" + location.host + "/luckysheet/websocket/luckysheet",
						gridKey: gridKey,
						loadUrl: location.origin + "/luckysheet/api/load",
						loadSheetUrl: location.origin + "/luckysheet/api/loadsheet"
					}
				} else {
					// http://localhost:3000/ 
					
					let data=[
						{
							"name": "Cell", //工作表名称
							"color": "", //工作表颜色
							"index": 0, //工作表索引
							"status": 1, //激活状态
							"order": 0, //工作表的下标
							"hide": 0,//是否隐藏
							"row": 36, //行数
							"column": 18, //列数
							"defaultRowHeight": 19, //自定义行高
							"defaultColWidth": 73, //自定义列宽
							"celldata": [], //初始化使用的单元格数据
							"config": {
								"merge":{}, //合并单元格
								"rowlen":{}, //表格行高
								"columnlen":{}, //表格列宽
								"rowhidden":{}, //隐藏行
								"colhidden":{}, //隐藏列
								"borderInfo":{}, //边框
								"authority":{}, //工作表保护
								
							},
							"scrollLeft": 0, //左右滚动条位置
							"scrollTop": 315, //上下滚动条位置
							"luckysheet_select_save": [], //选中的区域
							"calcChain": [],//公式链
							"isPivotTable":false,//是否数据透视表
							"pivotTable":{},//数据透视表设置
							"filter_select": {},//筛选范围
							"filter": null,//筛选配置
							"luckysheet_alternateformat_save": [], //交替颜色
							"luckysheet_alternateformat_save_modelCustom": [], //自定义交替颜色	
							"luckysheet_conditionformat_save": {},//条件格式
							"frozen": {}, //冻结行列配置
							"chart": [], //图表配置
							"zoomRatio":1, // 缩放比例
							"image":[], //图片
							"showGridLines": 1, //是否显示网格线
							"dataVerification":{} //数据验证配置
						},
						{
							"name": "Sheet2",
							"color": "",
							"index": 1,
							"status": 0,
							"order": 1,
							"celldata": [],
							"config": {}
						},
						{
							"name": "Sheet3",
							"color": "",
							"index": 2,
							"status": 0,
							"order": 2,
							"celldata": [],
							"config": {},
						}
					]
					data[0].celldata[0] = {
						"r": 9,
						"c": 2,
						"v": {
							"ct": {"yyyy-MM-dd":"","t":"d"},
						}
					}
					data[0].celldata[1] = {
						"r": 9,
						"c": 4,
						"v": {
							"ct": {"yyyy-MM-dd":"","t":"d"},
						}
					}
					data[0].celldata[2] = {
						"r": 9,
						"c": 6,
						"v": {
							"ct": {"yyyy-MM-dd":"","t":"d"},
						}
					}
					data[0].celldata[3] = {
						"r": 13,
						"c": 2,
						"v": {
							"ct": {"yyyy-MM-dd":"","t":"d"},
						}
					}
					data[0].celldata[4] = {
						"r": 10,
						"c": 4,
						"v": {
							"ct": {"fa":"","t":"trRa"},
							"data":[ { id: 1, pId: 0, name: "C25", open: true }, { id: 2, pId: 0, name: "C40", open: true }]
						}
					}
					options = {
						container: 'luckysheet',
						lang: lang,
						// pager: {
						// 	pageIndex: 1,
						// 	pageSize: 10,
						// 	total: 50,
						// 	selectOption: [10, 20]
						// },
						forceCalculation: false,
						plugins: ['chart'],
						showinfobar: false,
						showtoolbar: false,
						sheetFormulaBar: false,
						showstatisticBar: false,
						showsheetbar: false,
						data: data
						
						
					}
				}
				options.loading = {
					image: () => {
						return `<svg viewBox="25 25 50 50" class="circular">
					<circle cx="50" cy="50" r="20" fill="none"></circle>
					</svg>`
					},
					imageClass: "loadingAnimation"
				}
				options.cellRightClickConfig = {
					customs: [{
						title: 'test',
						onClick: function(clickEvent, event, params) {
							console.log('function test click', clickEvent, event, params)
						}
					}]
				}
				// let formula = luckysheet.getInsideVariable('formula')
				// let func_methods = luckysheet.getInsideVariable('func_methods')
				// let {
				// 	isRealNum,
				// 	isRealNull,
				// 	valueIsError,
				// 	error
				// } = luckysheet.getInsideVariable('validate')
				// let {
				// 	getObjType,
				// 	ABCatNum,
				// 	chatatABC,
				// 	numFormat
				// } = luckysheet.getInsideVariable('util')
				let customformula = new Customformula(luckysheet)
				options.customOptions = {
					Customformula: customformula.GetCustomformula()
				}
				luckysheet.create(options);
				luckysheet.setTreeDropDownData(0, 0, 1, 'trRa', [{
					id: 1,
					pId: 0,
					name: "火之国",
					open: true
				}, {
					id: 11,
					pId: 1,
					name: "木叶忍者",
					open: true
				}])
				luckysheet.setTreeDropDownData(1, 0, 2, 'trCh', [{
					id: 1,
					pId: 0,
					name: "火之国",
					open: true
				}, {
					id: 11,
					pId: 1,
					name: "木叶忍者",
					open: true
				}])
			})
		</script>
		<style>
			/* 自定义loading演示样式 */
			@keyframes loading-rotate {
				0% {
					transform: rotate(0deg);
				}

				100% {
					transform: rotate(360deg);
				}
			}

			@keyframes loading-dash {
				0% {
					stroke-dasharray: 1, 200;
					stroke-dashoffset: 0;
				}

				50% {
					stroke-dasharray: 90, 150;
					stroke-dashoffset: -40px;
				}

				100% {
					stroke-dasharray: 90, 150;
					stroke-dashoffset: -120px;
				}
			}

			.loadingAnimation {
				width: 3em;
				height: 3em;
				animation: loading-rotate 2s linear infinite;
			}

			.loadingAnimation circle {
				animation: loading-dash 1.5s ease-in-out infinite;
				stroke-dasharray: 90, 150;
				stroke-dashoffset: 0;
				stroke-width: 2;
				stroke: currentColor;
				stroke-linecap: round;
			}
		</style>
	</body>

</html>
